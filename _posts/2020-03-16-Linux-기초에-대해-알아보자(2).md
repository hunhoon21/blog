__Linux 기초에 대해 알아보자__ 시리즈 2번째 편입니다. 개인적으로 시리즈를 준비하며 사용법만 알았던 부분의 의미까지 이해할 수 있어 좋은 경험이었습니다. 아래에 나오는 명령어를 직접 리눅스에서 쳐보시기를 적극 권장 드립니다.

## 시작하며 
__Linux 기초에 대해 알아보자__ 2편은 
* 디렉토리 구조와 파일 찾는법

* 사용자와 권한

* 네트워크 기초  

  로 이루어져 있습니다.  


## 디렉토리 구조와 파일 찾는 법

### 디렉토리 구조 
![directory_struceture](../imgs/directory_structure.png) 
>[[위키피디아 file system 구조](https://www.thegeekstuff.com/2010/09/linux-file-system-structure/)]

  * `/`
    * 가장 깊은 곳에 있는 Root directory입니다.
* `/bin`
    * User Binaries (실행 가능한 프로그램)이 있는 디렉토리입니다. bash, ls 등 리눅스 터미널에서 실행 가능한 프로그램이 담기는 공간입니다.
* `/sbin`
    * System Binaries (루트 관리자가 사용하는 프로그램)이 있는 디렉토리 입니다. reboot, shutdown등의 프로그램이 담겨 있습니다.
* `/etc`
    * Conofiguration Files(설정에 관한 파일)이 담겨있습니다. 
    * wget 프로그램을 실행하는 경우에, 해당 wget 프로그램 동작 방법에 대한 설정이 wgetrc파일에 담겨있습니다. 예를 들자면, 파일을 다운 받는경우에 해당 웹서버에 접속을 시도하는 횟수와 같은 값을 설정할 수 있습니다.
* `/var`
    * 시스템 log 기록과 같이 내용이 금방 바뀔 수 있는 파일들이 담깁니다.
* `/tmp`
    * 임시 파일이 저장됩니다. 껐다 켜지면 해당 파일 사라집니다.
* `/home`
    * 사용자(User)의 디렉토리가 담깁니다. 저같은 경우는 henris라는 사용자 이름으로 디렉토리가 존재하는데요, `cd ~` 명령어를 통해 현재 사용자의 홈디렉토리가 바로 접근이 가능합니다.
* `/lib`
    * `/bin` 또는 `/sbin`에 담긴 프로그램이 사용하는 라이브러리가 저장되어 있습니다.

### 파일 찾는 법
파일은 `텍스트.txt`, `이미지.png`와 같이 우리에게 익숙한 파일과, `ls`와 같은 프로그램 실행로 분류됩니다. 아래에 나오는 명령어들 모두 `man` 명령어를 통해 매뉴얼을 직접 확인해보시기 바랍니다.
#### 파일 찾기

* `locate` 명렁어
  * 파일 정보들이 담긴 `mlocate` 라는 데이터베이스를 통해 파일을 찾는 명렁어입니다. 따라서 데이터베이스가 업데이트 되어있다면 빠르게 파일을 찾을 수 있습니다.
  * `$ locate *.log` 혹은 `$ locate 원하는파일` 과 같은 명령어로 실행합니다.

* `find` 명령어
    
    * 디렉토리를 직접 찾아보기 때문에 상대적으로 느립니다.
    * 마찬가지로 ` $ find 원하는파일` 같은 방식으로 사용하지만 `$ man find` 혹은 `$ man --help | head` 명령어로 확인해보면 더욱 다양한 기능을 활용할 수 있습니다.
* `$ find / -name *.log` 
        * 루트 디렉토리 하위에서 `.log` 라는 이름으로 끝나는 파일을 찾는 명령어입니다. 루트에 접근하는 만큼 접근 권한이 없는 디렉토리를 확인할 수 없습니다.
    * `$ find ~ -type f -name *.log` 
        * `.log` 라는 이름으로 끝나는  모든 파일을 찾는 명령어입니다. 디렉토리를 찾는 경우에는 타입에 `d` 를 입력하시면 됩니다.
    * `find . -type f -name “tecmint.txt” -exec rm -f {} \;` 
        * 현재 디렉토리 하위에서 `tecmint.txt` 를 찾고 있으면 조건없이 모두 지우는 명령어입니다.
    
    
    
    #### 실행파일 찾기
    
* `Whereis` 명렁어

    * 해당 프로그램의 위치와 매뉴얼 문서 위치를 알려줍니다.
    * `whereis ls` 를 입력하면 ls 파일의 위치와 매뉴얼 문서 위치를 알려줍니다.

    그렇다면.. 추가적으로 우리는 `ls` 명령어를 실제 위치인 `bin/ls` 에 접근하지 않고 어떻게 어느 디렉토리에서든 사용할 수 있는것일까요?

    * 환경 변수 덕분에  `/bin` 디렉토리에 접근하지 않고도 해당 프로그램의 실행파일을 실행할 수 있습니다.
    * `$ echo $PATH` 명령어로 `/bin` 디렉토리가 환경변수에 잡혀있는 것을 볼 수 있습니다.

## 사용자와 권한

### 사용자(User)

* 사용자
    * 다중사용자 1
        * 여러사람이 사용, 비밀이 생김. 각자의 아이디로 로그인 
        * 다중사용자 시스템의 경우 훨씬 복잡해진다. 권한에 대한 체크 등을 해야함
        * 다른사람이 내 프로그램을 함부로 다룰 수 있음.
        *  유닉스계열은 다중사용자시스템
    * id, who
        * $ id - 나는 누구인가 (identify)
        * $ who - 누가 누가 접속중인가
    * 관리자와 일반 사용자
        * super(root) user VS user
        * $ 는 일반 사용자, # super-user
        * Sudo superuser do
        * su 사용자 바꿀때
            * $ su - root
            * exit
        * sudo passwd -u root (ubuntu) 언락
            * Su - root
        * sudo passwd -l root 락
        * /root 는 루트사용자의 홈디렉토리 pwd 해보면 확인 가능
    * 사용자 추가
        * 구글링 참고 add user linux
        * sudo useradd -m someone
        * su - someone
        * su passed someone
        * someone은 현재 sudo 가 불가
        * sudo usermod -a -G sudo someone  (sudo 그룹에 넣어준 것!) append 

### 권한(Permission)

* 권한 기본
    * 보통 권한은 볼수 있게 하겠느냐 안하겠느냐
    * 유저에 대한
    * 파일과 디렉토리에 대한
    * 읽고 쓰고 실행에 대한 Read Write Excute
    * $ touch perm.txt
    * $ echo ‘hi’ > perm.txt
    * $ cat perm.txt
    * 소유자가 아닌 사람이 하면 거절당함 
    * 타입|access mode|1|owner group |0| rwx  기본 그림 있으면 좋을듯
        * permission.png
        * 타입은 d 아님 -
        * $ ls -l 을 보면 상세히
            * 읽기
              
                * Cat
            * 쓰기
              
                * >> > 둘다 안됨
            * 실행
              
                * 
    
* 권한을 변경하는 방법 - chomd o others u 사용자 g 그룹 a 모두 =그것만
    * chmod o-r perm.txt
    * chmod o+r perm.txt
    * chmod o+w perm.txt
    * chmod u-r perm.txt
        * 자신의 것이어도 권한을 없앨 수 있음
    
* 실행의 개념과 권한 설정 - execute
    * #!/bin/bash -> 실행권한이 있으면 /bin/bash와 함께 실행함
    * Echo ‘hi hi hi’
    * Nano hi.sh
    * ./hi.sh 실패
    * /bin/bash hi.sh
    * 파일자체를 실행할때는 실행 권한이 필요한 것
    
* 디렉토리의 권한
    * $ mkdir perm; cd perm; echo ‘hi’ > perm.txt
    * $ chmod o-r perm +도
    * r 없으면 폴더 내 정보를 열람할 수가 없음
        * $ ls -l perm
    * w 새로운 파일/폴더를 만들거나 삭제할 수 없음
        * $ touch a.txt
    * x cd를 통해 접근할 수 있느냐
        * $ cd perm
    * chmod -R o+w perm 모든 파일/폴더에 대한 권한 수정
    
* chmod 총정리
    * chmod [options] mode[,mode] file1 [file2 …]
https://en.wikipedia.org/wiki/Chmod
    * (위키 참조) octal mode 로 8진수로 다 처리할 수 있음
        * 사용자, 그룹, other에 대한
    * chmod 222 perm.txt
    * a +- = 연산자 사용가능 a는 all
    
* 그룹
    * 일부 유저에게만 그룹으로 묶어 권한을 줄 수 있음
    * Add group in linux 검색
        * Developer, designer, …
        * (위키참조)
            * Sudo grouped developer (!!) -> 직전 명령어
            * nano etc/group
            * usermod -a -G developer henris
            * sudo chown root:developer .
            * Sudo chmod g+w . => 이제 쓰기 가능

## 네트워크 기초

* 인터넷
    * (그림) Clint <-> server
    * internet1.png
    * request, response
    * 요청하고 반응이 인터넷이 돌아가는 원리
    * 생산자(서버)로서의 이야기
    * google.com => domain name
    * IP address
    * ping google.com
    * 도메인네임과 아이피 둘다로 접근 할 수 있음
    * 둘의 관계를 알아야 함
    * 두개의 전화기 전화번호로 입력할 수 있음. 저장한 이름으로도 걸 수 있음
    * 도메인네임은 실제로 아이피로 연결되는 것
    * 알려준적이 없는데 도메인네임이 아이피로 연결되는가?
    * DNS 서버, 모든 도메인이 어떤 아이피를 가지는 알려주는 전화번호부
    * DNS 서버(데이터베이스 뒤짐)에 자동으로 연결되어 주소를 얻어옴
    * 내 아이피 주소를 알려줘야 다른사람을 초대 할 수 있음
￼
* 인터넷 2 (그림 있으면 좋은데..)
    * $ ip addr => inet 찾으면 private ip
    * ipinfo.iio/ip 주소로 접근 (39.115.117.118) 결과적인 IP - Public address
    * curl ipinfo.io/ip => public
    * ipconfig getifaddr en0(맥북) (192.168.35.203) => 컴퓨터에 부여된 실제 IP 프라이빗
    * 중간에 라우터가 있음. 
    * curl이 퍼블릭을 알아내는 것
    * Public Address 를 쓰는 경우에 통신 하는 방법
        * 1. 같은 공유기를 쓰는 다른 컴퓨터가 내 private 주소로 접근
        * 2. Public 주소로 접근하고, 
* Web Server
    * 내 컴퓨터에 웹서버를 설치하면 모든 사람들이 접근 가능
    * Client(WB) <-> Server(WS)
    * 클라이언트가 google.com/index.html을 보고싶다고 요청하면 웹서버가 요청을 해석해서 자신의 하드에 있는 index.html을 클라이언트에 보내줌
    * WB - 크롬, 파이어폭스
    * WS - 아파치, nginx
* 아파치 
    * brew search apache
    * Brew install apache2
    * Brew services start httpd
    * Brew install delinks
    * elinks
    * localhost 로도 접근 가능
    * 자신의 컴퓨터에 있는 웹서버에 접근한다.
    * 127.0.0.1 의 도메인네임은 localhost
* configuration
    * WB -> WS [storage-HD]
    * /etc에 configuration 있음
    * /etc/apache2
* SSH
    * linux는 서버 시장에서 엄청 큼
    * 사물인터넷을 쓰는 안에 들어있는 컴퓨터는 리눅스로 되어있음
    * Client(나)는 server(linux 계열의 컴퓨터)를 제어함 ssh client / ssh server 각각 설치
    * 실제로 회사에서 사용중
* 실습
    * openssh-server  서버에 설치
    * Sudo service ssh start
    * Sudo ps aux | grep ssh
    * ssh henris@192.168.0.65 -> 접속해서 그냥 자기 컴퓨터 다루듯이 하면 됨!
    * ssh -p 44445 hooncheol.shin@proxy.makinarocks.ai

* 포트 1 - 포트란 무엇인가?
    * naver.com:80 접속 가능, 나머지는 안됨
    * ssh -p 22 ~ 는 보통 기본설정으로 잡고 있음
    * (그림)
    * 웹서버는 80, ssh는 22번에 기본적으로 연결되어 있음
￼
    * 1024 이후 번호로 커스터마이징 해서 포트번호 사용
    * /etc/ssh/sshd_config
* 포트 2 - 포트포워딩
    * (그림)
￼
    * ISP - Router - computers
    * 기본적으로는 ip주소만으로는 public-private 접속 불가
    * 포트번호를 통해 외부-개인 컴퓨터로 접속 가능 
    * 공유기의 환경설정으로 포트번호 처리를 가능하게 함
    * default gateway 알아내기
    * Ip route 의 192.168.0.1 이 디폴트게이트웨이
￼
    * (직장이나 회사는 라우터 접속 불가)
    * 로그인해서 NAT/라우터 관리 - 포트포워드 관리 외부포트9000 내부포트 80 하면 내 웹서버로 연결
    * ssh -p 9000 henris@211.46.24.37
* 도메인(Domain Name System)
    * 도메인 기본 개념
        * DNS 서버에먼저 접근해서 google.com=>216.58.197.174
    ￼

    * Hosts 파일
        * 기존에는 호스트 파일에 다 적혀있었음
        * /etc/hosts 자주가는 도메인/ip 주소 적어둘 수 있음
        * 호스트파일 없으면 dns 서버 감
        * 클라이언트와 서버 모두 호스트, 호스트가 묶여있으면 네트워크
        * 네트워크가 합쳐져서 인터넷
        * 호스트파일은 보안이 중요함. 백신이 보호하는 역할을 하기도
    * 도메인 구입
    ￼
* ICANN 에서 도메인을 관리함.
    * 독점적으로 하고 싶으면 도메인을 구매해야 함 .com/.net 은 10불정도
    * https://www.freenom.com/en/index.html?lang=en
    * 여기서 도메인 살 수 있음
    * host henris.ga 로 연결이 붙었는지 확인가능
* 서브도메인 prefix 다르게 해서 서로 다른 ip 주게 할 수 있음
  ￼