지금까지 Linux를 접하며 서버에 접속해보고 Linux 서버에서 많은 머신러닝 실험을 돌려보면서도, 'Linux를 다룬다' 라고 생각하진 않았습니다. 최근 도커를 공부하며 Linux 기초를 공부하고 싶다는 생각이 들어 인프런에 올라온 [생활코딩 - Linux]([https://www.inflearn.com/course/%EC%83%9D%ED%99%9C%EC%BD%94%EB%94%A9-%EB%A6%AC%EB%88%85%EC%8A%A4-%EA%B0%95%EC%A2%8C/dashboard](https://www.inflearn.com/course/생활코딩-리눅스-강좌/dashboard)) 을 주말동안 들었고, 그 내용을 정리했음을 밝힙니다. 개인적으로 끄적끄적 사용해보던 Linux에 대해 직접 공부해보니 무척 재밌더라구요! 쉘의 개념, 권한, 네트워크 등 정말 흥미로운 내용을 담고 있으니 직접 수강해보기를 추천드립니다. 시간을 아끼시고 싶으신 분은 블로그 내용을 참고해도 좋을 것 같습니다 ☺️

## 시작하며

Linux는 UNIX 계열의 운영 체제이고, 소스 코드가 공개된 오픈소스 운영체제입니다. 우리나라에서는 Windows를 사용하는 사람이 많지만, 서버나 I.O.T 제품에 들어가는 컴퓨터는 Linux 기반인 경우가 <u>굉장히</u> 많고, 그만큼 개발자들에게 친숙한 운영체제입니다. Linux 기초에 대해 알아보도록 하겠습니다.



## Linux 기초

### Linux 기초 명령어

* ```$ ls  # 현재 디렉토리의 파일/폴더를 열람하는 명령어입니다.```
* ```$ pwd  # 현재 디렉토리의 경로를 얻는 명령어입니다.```
* ```$ mkdir some_dir  # 새로운 디렉토리를 만드는 명령어입니다.```
* ```$ cd some_dir # 디렉토리로 접근하는 명령어입니다.```
* ```$ rm some # 파일 혹은 폴더를 지우는 명령어입니다. 폴더를 지우기 위해서는 -r 이라는 옵션이 필요합니다. ```
* ```$ cp some1 some2  # 파일 혹은 폴더를 some2dp 복사하는 명령어입니다. ```
* ```mv some1 some2  # 파일 혹은 폴더를 some2에 이동시키는 명령어입니다. some1의 이름을 바꾸는 것으로도 활용할 수 있습니다.```

### Linux 명령어 사용법 알기

명령어의 사용법을 제대로 아는 방법은 무엇일까요? 구글링도 정말 좋은 방법이지만, 무엇보다도 document를 읽을 수 있는 능력이 중요하다고 생각합니다. 

### 

- —help와 man

- - 검색할땐 /sort n n n
  - 읽는 방법 -> Usage를 본다.
  - Mkdir -p 부모까지 리컬시브하게 만들어라.



## IO Redirection

- Input Output 방향을 바꿔준다.

- - ls -l > result.txt
  - cat result.txt
  - 방향을 돌려서 파일에 저장시킴
  - ls 라는 프로그램, 명령어 실행
  - 보통은 출력을 화면에 해줌(Standard Output), 모니터
  - \> 리다이렉션 의미
  - 프로세스의 처리 결과의 방향을 바꿔줌
  - 오류는 Standard Error 로 출력
  - 2> 는 Standard Errorfmf redirection 해줌
  - Rm rename.txt 1> output.txt 2> error.log 로 활용 가능

- IO Redirection - Input

- - cat hello.txt
  - cat
  - hi -> hi 
  - unix program cat 임
  - cat < hello.txt
  - Command-line argument vs Standard Input을 바꿔주는 것
  - \```head -n1 < linux > one.txt```

- IO Redirection - append

- - ls -al >> result.txt
  - Mail [hunhoon21@gmail.com](mailto:hunhoon21@gmail.com) <<eot -> eot 나오면 끝내라
  - ls -al > /dev/null (unix 계열의 쓰레기통)

## 쉘과 쉘스크립트

- Shell 1 - intro 그림 찾아보기

- - Shell(껍데기) vs Kernel
  - 커널은 물리적인 기기를 감싸줌
  - 쉘은 껍데기처럼 커널을 감싸고 있음. 사용자
  - 우리 명령어를 쉘이 받아서 커널이 이해할 수 있도록 줌

- Bash vs zsh

- - Echo “hello”

  - Echo $0

  - - Bash
    - Zsh

  - 탭을 통해 둘의 차이를 볼 수 있음, 자동완성도

  - 선호하는 쉘을 설치하여 커널과 커뮤니케이션 하는것 (그림 추가하자)

- 쉘스크립트 소개하기

- - 내 사례 소개하기

  - /bin 에 명령어들 담겨있음

  - \#!/bin/bash 아래 명령어가 빈배쉬에 의해 해석되어야 한다

  - - If ! [ -d bak ]; then

    - - Mkdir bak

    - fi

    - cp *.log bak

    - chmod +x backup 왼쪽이 바뀜 x=>excutable

    - 앞에 bash를 붙이는것과 안붙이는 것의 차이는?



## 디렉토리 구조와 파일 찾는 법

- 디렉토리 구조 (https://www.thegeekstuff.com/2010/09/linux-file-system-structure/)

- - / - Root
  - /bin - User Binaries (실행 가능한 프로그램)
  - /sbin - System Binaries (루트 관리자가 사용하는 프로그램)
  - /etc - Conofiguration Files 설정에 관한 파일들이 담겨있음
  - /var 내용이 바뀔 수 있는 특성이 있음 log와 같이 금방금방 바뀌는 것
  - /tmp 임시 파일 저장, 껐다 켜지면 파일 사라짐
  - /home 홈디렉토리
  - /opt 소프트웨어 설치할 때 애매하면 넣기 좋은곳
  - /usr 

- 파일 찾는 법

- - 파일 vs 실행파일

  - locate *.log

  - - 데이터베이스를 뒤짐
    - mlocate  

  - find *.log

  - find —help | head

  - find / -name *.log

  - find ~ -type f -name *.log

  - find . -type f -name “tecmint.txt” -exec rm -f {} \;

- Whereis 실행파일을 찾아줌

- - whereis ls
  - Echo $PATH 환경변수



- 프로세스와 실행

- - 컴퓨터 구조 (개략그림 필요)

  - - Storage
    - RAM (메모리)
    - CPU (Processor)
    - 프로세스 - 사용자가 입력하는 명령어 - command(mkdir, top, …)
    - 파일형태 - 프로그램
    - 스토리지에 프로그램이 파일형태로 저장되어 있고, 사용자가 명령어를 치면 스토리지의 프로그램이 메모리에 올라와서 실행된다. 이 실행된 것을 프로세스라 부르고 프로세서가 처리한다.

  - 프로세스 모니터링

  - - ps

    - - ps aux

      - ps aux | grep apache

      - - P_ID 프로세스 아이디 이것을 죽일 수 있음

        - - Kill 22142

    - htop

  - 백그라운드 실행

  - - fore-ground

    - - jobs
      - ctl+z
      - fg %2 (jobs로 번호 확인)

    - Ls -R / > result.txt 2> error.log

    - Ls -R / > result.txt 2> error.log & 백그라운드로 실행

  - 항상 실행 - 데몬의 개념 (기본 개념 필요)

  - - 우리가 실행하는 명령어와는 다르게 항상 켜져 있는 프로그램을 뜻함
    - Server 는 데몬
    - 서버쪽 컴퓨터에는 웹서버라는 프로그램이 있고 클라이언트의 요청이 언제 들어올지 모르기 때문에 항상 켜져있다.

  - 항상실행 - service와 자동실행

  - - /etc/init.d 디렉토리에는 데몬 프로그램이 설치되어 있음
    - sudo service zookeeper start
    - ps aux | grep zookeeper 로 확인 가능
    - sudo service zookeeper stop
    - etc/rc3.d

  - 정기적 실행(cron) 1

  - - 정기적으로 실행해야 하는 프로그램을 실행시켜주는 도구 혹은 소프트웨어

    - crontab -e

    - m 분당 h 시간당 dom dow 요일

    - - */1 * * * * date >> date.log 2>&1

    - tail -f date.log

  - 정기적 실행(cron) 2

  - - 클라이언트가 응답을 기다리지 않을 수 있도록 웹서버에서 일단 처리하고 cron으로 메일링 작업을 함

  - 쉘을 시작할 때 실행

  - - alias l=‘ls -al’
    - .bashrc 수정으로 alias 가 매번 실행되는 것

- 사용자

- - 다중사용자 1

  - - 여러사람이 사용, 
    - 훨씬 복잡해진다. 권한에 대한 체크 등을 해야함

  - id, who

  - - $ id - 나는 누구인가
    - who - 누가 누가 접속중인가

  - 관리자와 일반 사용자

  - - super(root) user VS user

    - $ 는 일반 사용자, # super-user

    - su 사용자 바꿀때

    - - su - root
      - exit

    - sudo passwd -u root (ubuntu)

    - - Su - root

    - sudo passwd -l root

    - /root 는 루트사용자의 홈디렉토리

  - 사용자 추가

  - sudo useradd -m someone

  - su - someone

  - su passed someone

  - someone은 현재 sudo 가 불가

  - sudo user mod -a -G sudo someone (sudo 그룹에 넣어준 것!)



- 권한(Permission

- - 권한 기본

  - - 유저에 대한
    - 파일과 디렉토리에 대한
    - 읽고 쓰고 실행에 대한
    - echo ‘hi’ > perm.txt
    - 소유자가 아닌 사람이 하면 거절당함 
    - 타입|access mode|1|owner group |0| rwx 기본 그림 있으면 좋을듯

  - 권한을 변경하는 방법 - chomd o others u 사용자 g 그룹 a 모두 =그것만

  - - chmod o-r perm.txt
    - chmod o+r perm.txt
    - chmod o+w perm.txt
    - chmod u-r perm.txt

  - 실행의 개념과 권한 설정 - execute

  - - \#!/bin/bash
    - Echo ‘hi hi hi’
    - Nano hi.sh
    - ./hi.sh 실패
    - /bin/bash hi.sh
    - 파일자체를 실행할때는 실행 권한이 필요한 것

  - 디렉토리의 권한

  - - r 없으면 폴더 내 정보를 열람할 수가 없음
    - w 새로운 파일/폴더를 만들거나 삭제할 수 없음
    - x cd를 통해 접근할 수 있느냐
    - chmod -R o+w perm 모든 파일/폴더에 대한 권한 수정

  - chmod 총정리

  - - chmod [options] mode[,mode] file1 [file2 …]
    - (위키 참조) octal mode 로 8진수로 다 처리할 수 있음
    - chmod 222 perm.txt

  - 그룹

  - - 일부 유저에게만 그룹으로 묶어 권한을 줄 수 있음

    - - Developer, designer, …

      - (위키참조)

      - - Sudo grouped developer (!!) -> 직전 명령어
        - nano etc/group
        - usermod -a -G developer henris
        - sudo chown root:developer .
        - Sudo chmod g+w . => 이제 쓰기 가능



- 인터넷, 네트워크, 서버

- - 인터넷

  - - (그림) Clint <-> server
    - request, response
    - 요청하고 반응이 인터넷이 돌아가는 원리
    - 생산자(서버)로서의 이야기
    - [google.com](http://google.com) => domain name
    - IP address
    - ping [google.com](http://google.com)
    - 도메인네임과 아이피 둘다로 접근 할 수 있음
    - 둘의 관계를 알아야 함
    - 두개의 전화기 전화번호로 입력할 수 있음. 저장한 이름으로도 걸 수 있음
    - 도메인네임은 실제로 아이피로 연결되는 것
    - 알려준적이 없는데 도메인네임이 아이피로 연결되는가?
    - DNS 서버, 모든 도메인이 어떤 아이피를 가지는 알려주는 전화번호부
    - DNS 서버(데이터베이스 뒤짐)에 자동으로 연결되어 주소를 얻어옴
    - 내 아이피 주소를 알려줘야 다른사람을 초대 할 수 있음



- - 인터넷 2 (그림 있으면 좋은데..)

  - - ip addr

    - ipinfo.iio/ip 주소로 접근 (39.115.117.118) 결과적인 IP - Public address

    - curl ipinfo.io/ip

    - ipconfig getifaddr en0(맥북) (192.168.35.203) => 컴퓨터에 부여된 실제 IP 프라이빗

    - 중간에 라우터가 있음. 

    - curl이 퍼블릭을 알아내는 것

    - Public Address 를 쓰는 경우에 통신 하는 방법

    - - \1. 같은 공유기를 쓰는 다른 컴퓨터가 내 private 주소로 접근
      - \2. Public 주소로 접근하고, 

  - Web Server

  - - 내 컴퓨터에 웹서버를 설치하면 모든 사람들이 접근 가능
    - Client(WB) <-> Server(WS)
    - 클라이언트가 [google.com/index.html을](http://google.com/index.html을) 보고싶다고 요청하면 웹서버가 요청을 해석해서 자신의 하드에 있는 index.html을 클라이언트에 보내줌
    - WB - 크롬, 파이어폭스
    - WS - 아파치, nginx

  - 아파치 

  - - brew search apache
    - Brew install apache2
    - Brew services start httpd
    - Brew install delinks
    - elinks
    - localhost 로도 접근 가능
    - 자신의 컴퓨터에 있는 웹서버에 접근한다.
    - 127.0.0.1 의 도메인네임은 localhost

  - configuration

  - - WB -> WS [storage-HD]
    - /etc에 configuration 있음
    - /etc/apache2

  - SSH

  - - linux는 서버 시장에서 엄청 큼
    - 사물인터넷을 쓰는 안에 들어있는 컴퓨터는 리눅스로 되어있음
    - Client(나)는 server(linux 계열의 컴퓨터)를 제어함 ssh client / ssh server 각각 설치
    - 실제로 회사에서 사용중

  - 실습

  - - openssh-server 서버에 설치
    - Sudo service ssh start
    - Sudo ps aux | grep ssh
    - ssh [henris@192.168.0.65](mailto:henris@192.168.0.65) -> 접속해서 그냥 자기 컴퓨터 다루듯이 하면 됨!
    - ssh -p 44445 [hooncheol.shin@proxy.makinarocks.ai](mailto:hooncheol.shin@proxy.makinarocks.ai)



- - 포트 1 - 포트란 무엇인가?

  - - [naver.com:80](http://naver.com:80) 접속 가능, 나머지는 안됨
    - ssh -p 22 ~ 는 보통 기본설정으로 잡고 있음
    - (그림)
    - 웹서버는 80, ssh는 22번에 기본적으로 연결되어 있음



- - - 1024 이후 번호로 커스터마이징 해서 포트번호 사용
    - /etc/ssh/sshd_config

  - 포트 2 - 포트포워딩

  - - (그림)



- - - ISP - Router - computers
    - 기본적으로는 ip주소만으로는 public-private 접속 불가
    - 포트번호를 통해 외부-개인 컴퓨터로 접속 가능 
    - 공유기의 환경설정으로 포트번호 처리를 가능하게 함
    - default gateway 알아내기
    - Ip route 의 192.168.0.1 이 디폴트게이트웨이



- - - (직장이나 회사는 라우터 접속 불가)
    - 로그인해서 NAT/라우터 관리 - 포트포워드 관리 외부포트9000 내부포트 80 하면 내 웹서버로 연결
    - ssh -p 9000 [henris@211.46.24.37](mailto:henris@211.46.24.37)

- 도메인(Domain Name System)

- - 도메인 기본 개념

  - - DNS 서버에먼저 접근해서 [google.com](http://google.com)=>216.58.197.174





- - Hosts 파일

  - - 기존에는 호스트 파일에 다 적혀있었음
    - /etc/hosts 자주가는 도메인/ip 주소 적어둘 수 있음
    - 호스트파일 없으면 dns 서버 감
    - 클라이언트와 서버 모두 호스트, 호스트가 묶여있으면 네트워크
    - 네트워크가 합쳐져서 인터넷
    - 호스트파일은 보안이 중요함. 백신이 보호하는 역할을 하기도

  - 도메인 구입





- ICANN 에서 도메인을 관리함.

- - 독점적으로 하고 싶으면 도메인을 구매해야 함 .com/.net 은 10불정도
  - https://www.freenom.com/en/index.html?lang=en
  - 여기서 도메인 살 수 있음
  - host henris.ga 로 연결이 붙었는지 확인가능

- 서브도메인 prefix 다르게 해서 서로 다른 ip 주게 할 수 있음